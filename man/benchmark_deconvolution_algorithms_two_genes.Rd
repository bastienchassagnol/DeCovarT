% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02_simulations.R
\name{benchmark_deconvolution_algorithms_two_genes}
\alias{benchmark_deconvolution_algorithms_two_genes}
\title{Benchmark two-component cell populations}
\usage{
benchmark_deconvolution_algorithms_two_genes(
  proportions = list(balanced = c(0.5, 0.5), `small unbalanced` = c(0.6, 0.4),
    `highly unbalanced` = c(0.05, 0.95)),
  signature_matrices = list(`small OVL` = matrix(c(20, 40, 40, 20), nrow = 2)),
  corr_sequence = seq(-0.8, 0.8, 0.2),
  diagonal_terms = list(homoscedastic = c(1, 1), heteroscedastic = c(1, 2)),
  deconvolution_functions = list(lm = list(FUN = deconvolute_ratios_abbas,
    additionnal_parameters = NULL)),
  n = 200,
  scaled = FALSE
)
}
\arguments{
\item{proportions}{A list of numerical vectors, assumed each to respect the unit
simplex constraint:
\deqn{\begin{cases} \sum_{j=1}^J p_{j}=1\\ \forall j \in \widetilde{J} \quad p_j\ge 0 \end{cases}}}

\item{signature_matrices}{A list of bivariate matrices, in \eqn{\mathcal{M}_{G \times J}^+}
storing the purified expression profiles of the \eqn{J} cell populations of the sample.
This parameter is especially useful to assert the performance of the deconvolution
algorithms, as a function of the proximity of the respective centroids (mean
expression profiles) of the evaluated cell populations.}

\item{diagonal_terms, corr_sequence}{Together, these parameters control the
characteristics of the array of covariance matrices used to model the transcriptomic
network structure of each cell population:
\itemize{
\item A numeric vector, strictly included between -1 and 1, is expected for
param \code{corr_sequence}. Each paired arrangement of correlation for both cell
populations will be used to describe the pairwise correlation level between
gene 1 and gene 2.
\item A list of numeric vectors, used to parametrise the diagonal terms of
the covariance matrix, is expected for param \code{diagonal_terms}. Explicit
names can be given as well to properly identify a scenario.  By default,
we compare a standard \emph{homoscedastic} scenario, in which we assume a constant diagonal term
of 1 for both genes, with a \emph{heteroscedastic} scenario, in which we assign
a variance of 2 for gene 2, for both cell populations. Finally, the covariance
matrix is computed and normalised back to integrate both constraints, using
following matricial relationship, linking the value of a correlation matrix with
its respective covariance matrix:
\deqn{\text{Cov}(\boldsymbol{X}) = \text{diag}\left[(\text{Var}(\boldsymbol{X})\right]^{1/2} \times \text{Cor}(\boldsymbol{X}) \times \text{diag}\left[(\text{Var}(\boldsymbol{X})\right]^{1/2}}
}}

\item{deconvolution_functions}{The deconvolution functions themselves, as reported in}

\item{scaled}{Whether we should scale or not the dataset. By default, we consider that the provided dataset is in its original raw space,
and we do not scale the dataset, since our deconvolution algorithm assumes a multivariate Gaussian distribution on the raw counts themselves.}
}
\value{
a two-entry list, with:
\itemize{
\item \code{config}: the complete parameter configuration used to generate the benchmark
including the list of parameters, as well as some general metrics, such as the
overlap and the entropy of the convolution of GMMs used
\item \code{simulations}: the results of the simulations themselves,
mostly similar to the output of \link{deconvolute_ratios}
}
}
\description{
It is a highly specific wrapper function, used to reproduce the results
for the bivariate toy example provided in the paper associated to this package.
Precisely, it has been designed to predict the performance of a variety of deconvolution
algorithms, in the specific framework where two cell populations are characterised
by two genes.
}
\details{
Purpose of this toy example was to evaluate the quality of the benchmark
with respect to the level of entropy (the global population disequilibrium)
and the overlap, in a two dimensional convolution of Gaussian mixture distributions.
}
\note{
In a near future, we would provide an additional and more flexible
benchmark, however, till now, we strongly do not recommend to benchmark
virtual mixtures with more than two populations, since, with only two genes,
you are likely to come across strong identifiability issues.
}
\seealso{
\code{\link[=deconvolute_ratios]{deconvolute_ratios()}}
}
